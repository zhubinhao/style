<!doctype html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<link href="../../css/mui.min.css" rel="stylesheet" />
		<link rel="stylesheet" type="text/css" href="../../css/style.css" />
	</head>

	<body id="read">
		<header class="mui-bar mui-bar-nav">
			<a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a>
			<h1 class="mui-title">{{title}}</h1>
		</header>
		<div class="mui-content" id="refreshContainer" v-cloak>
			<ul class="mui-table-view">
				<li class="mui-table-view-cell" v-for='i in list' @tap="naveTo(i)">
					<div class="mui-table">
						<div class="mui-table-cell mui-col-xs-11 ">
							<p class="mui-ellipsis" style="color: black;overflow: hidden;">业务名称：{{i.mod_name}}</p>
							<h5><span style="color: black;">业务说明：</span>{{i.bill_title}}</h5>
							<h5><span style="color: black;">到达时间：</span>{{i.arrive_date}}</h5>
							<h5><span style="color: black;">发&nbsp;&nbsp;起&nbsp;&nbsp;人：</span>{{i.start_human}}</h5>
							<h5><span style="color: black;">发起部门：</span>{{i.start_mbsdept_name}}</h5>
							<h5><span style="color: black;">发起时间：</span>{{i.start_date}}</h5>
						</div>
					</div>
				</li>
			</ul>
		</div>
		<script src="../../js/mui.min1.js"></script>
		<script src="../../js/vue.js"></script>
		<script src="../../js/serve.js"></script>
		<script type="text/javascript">
			var deceleration = mui.os.ios ? 44.003 : 0.0009;

			var read = new Vue({
				el: "#read",
				data: {
					title: '',
					type: '',
					list: [],
					obj: {}
				},
				ready: function() {
					var serf = this;
					mui.init({
						swipeBack: true,
						pullRefresh: {
							container: "#refreshContainer", //下拉刷新容器标识，querySelector能定位的css选择器均可，比如：id、.class等
							down: {
								style: 'circle', //必选，下拉刷新样式，目前支持原生5+ ‘circle’ 样式
								color: '#2BD009', //可选，默认“#2BD009” 下拉刷新控件颜色
								height: '50px', //可选,默认50px.下拉刷新控件的高度,
								range: '100px', //可选 默认100px,控件可下拉拖拽的范围
								offset: '44px', //可选 默认0px,下拉刷新控件的起始位置
								auto: true, //可选,默认false.首次加载自动上拉刷新一次							      
								callback: serf.countlist
							},
						}
					});
					mui.plusReady(function() {
						var selfff = plus.webview.currentWebview();
						serf.title = selfff.title;
						serf.type = selfff.ID;
						var obj = JSON.parse(plus.storage.getItem("loginData"))
						serf.obj = obj
					})
				},
				methods: {			
					countlist: function(type) {											
						var data = {
							"accountname": this.obj.accountname,
							"human_sid": this.obj.human_sid,
							"sType": this.type
						}
						TB.get("GetWfdataList/", JSON.stringify(data), function(res) {
							var list = []
							res.data.forEach(function(res) {
								list.push(JSON.parse(res))
							})
							this.list = list
							mui('#refreshContainer').pullRefresh().endPulldown();
						}.bind(this), function() {
							this.list = []

						}.bind(this))

					},

					naveTo: function(item) {
						var sef = this;
						mui.openWindow({
							url: 'readingxq.html',
							id: 'readingxq',
							extras: item,
							show: {
								aniShow: 'slide-in-right'
							},
							waiting: {
								autoShow: false, //自动显示等待框，默认为true					      

							}
						})

					}
				}
			})
		</script>
	</body>

</html>